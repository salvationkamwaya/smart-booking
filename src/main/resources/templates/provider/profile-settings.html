<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Appointments - Profile Settings</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'white-smoke': '#F5F5F5',
                        'deep-sky-blue': '#00B7EB',
                        'midnight-blue': '#191970',
                        'crimson': '#DC143C',
                        'sea-green': '#2E8B57',
                        'light-gray': '#EDF2F7',
                        'dark-gray': '#2D3748',
                        'teal-blue': '#26A69A',
                        'royal-purple': '#7857FE',
                    },
                    boxShadow: {
                        'card': '0 4px 20px rgba(0, 0, 0, 0.05)',
                        'sidebar': '5px 0 15px rgba(0, 0, 0, 0.1)'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        .sidebar-link {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .sidebar-link:hover, .sidebar-link.active {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: #26A69A;
        }

        .notification-dot {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background-color: #DC143C;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .user-avatar {
            transition: all 0.3s ease;
        }        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 0 0 3px rgba(38, 166, 154, 0.3);
        }

        /* Toggle Switch Styles */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #26A69A;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Badge Styles */
        .verification-badge, .security-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            margin: 0.25rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .verification-badge {
            background-color: rgba(34, 197, 94, 0.1);
            color: #059669;
        }

        .security-badge {
            background-color: rgba(59, 130, 246, 0.1);
            color: #2563eb;
        }

        /* Social Icons */
        .social-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .social-icon.facebook { background-color: #3b5998; }
        .social-icon.twitter { background-color: #1da1f2; }
        .social-icon.linkedin { background-color: #0077b5; }
        .social-icon.instagram { background-color: #e4405f; }

        .social-icon:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* Tab Styles */
        .tab-button {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            color: #6b7280;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            color: #26A69A;
            border-bottom-color: #26A69A;
        }

        .tab-button:hover {
            color: #26A69A;
        }
        
        @media (max-width: 768px) {
            #sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                height: 100vh;
                z-index: 100;
                transition: all 0.3s ease;
            }
            #sidebar.active {
                left: 0;
            }
            #content-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 99;
            }
            #sidebar.active + #content-overlay {
                display: block;
            }
        }
    </style>
</head>
<body class="bg-white-smoke">
    <!-- Navigation Bar -->
    <nav class="bg-teal-blue text-white p-4 fixed top-0 w-full z-50 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center">
                <button id="toggle-sidebar" class="md:hidden mr-4 text-white">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div class="flex items-center">
                    <i class="fas fa-calendar-check text-xl mr-2"></i>
                    <h1 class="text-xl font-bold">Smart Appointments</h1>
                </div>
            </div>
            <div id="user-menu" class="flex items-center space-x-4">
                <div class="relative">
                    <button class="text-white p-2">
                        <i class="fas fa-bell text-xl"></i>
                        <span class="notification-dot">2</span>
                    </button>
                </div>
                <div class="hidden md:flex items-center">
                    <div class="user-avatar w-10 h-10 rounded-full bg-white flex items-center justify-center text-teal-blue font-bold mr-2">P</div>
                    <span id="user-name" class="font-medium">Provider</span>
                </div>
                <button id="logout-btn" class="bg-crimson hover:bg-white hover:text-crimson px-4 py-2 rounded transition-colors flex items-center">
                    <i class="fas fa-sign-out-alt mr-2"></i>
                    <span class="hidden sm:inline">Logout</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Layout with Sidebar -->
    <div class="flex min-h-screen pt-16">
        <!-- Sidebar -->
        <aside id="sidebar" class="w-64 bg-midnight-blue text-white p-6 fixed top-16 h-full md:block transition-all duration-300 z-40 shadow-sidebar">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-xl font-semibold flex items-center">
                    <i class="fas fa-user-md mr-2 text-teal-blue"></i>
                    Provider Menu
                </h2>
                <button id="close-sidebar" class="md:hidden p-2 text-white rounded-full hover:bg-teal-blue">
                    <i class="fas fa-times w-4 h-4"></i>
                </button>
            </div>
            <nav>
                <ul class="space-y-2">
                    <li>
                        <a th:href="@{/provider/provider-panel}" id="dashboard" class="sidebar-link block px-4 py-3 rounded-lg transition-colors flex items-center">
                            <i class="fas fa-tachometer-alt mr-3 text-teal-blue"></i> Dashboard
                        </a>
                    </li>
                    <li>
                        <a th:href="@{/provider/my-appointments}" id="my-appointments" class="sidebar-link block px-4 py-3 rounded-lg transition-colors flex items-center">
                            <i class="fas fa-calendar-alt mr-3 text-sea-green"></i> My Appointments
                        </a>
                    </li>
                    <li>
                        <a th:href="@{/provider/view-calendar}" id="view-calendar" class="sidebar-link block px-4 py-3 rounded-lg transition-colors flex items-center">
                            <i class="fas fa-calendar mr-3 text-deep-sky-blue"></i> View Calendar
                        </a>
                    </li>
                    <li>
                        <a th:href="@{/provider/add-slot}" id="add-slot" class="sidebar-link block px-4 py-3 rounded-lg transition-colors flex items-center">
                            <i class="fas fa-plus-circle mr-3 text-royal-purple"></i> Add Time Slot
                        </a>
                    </li>
                    <li>
                        <a th:href="@{/provider/profile-settings}" id="profile-settings" class="sidebar-link block px-4 py-3 rounded-lg transition-colors flex items-center active">
                            <i class="fas fa-user-cog mr-3 text-teal-blue"></i> Profile Settings
                        </a>
                    </li>
                    <li>
                        <a th:href="@{/provider/settings}" id="settings" class="sidebar-link block px-4 py-3 rounded-lg transition-colors flex items-center">
                            <i class="fas fa-cogs mr-3 text-sea-green"></i> Settings
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-64 p-8">
            <!-- Your existing profile settings content here -->
            <!-- Page Header -->
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-gray-800">Profile Settings</h1>
                <p class="text-gray-600 mt-2">Manage your personal and professional information</p>
            </div>

            <!-- Profile Header -->
            <div class="profile-card bg-white rounded-xl shadow-sm p-6 mb-6">
                <div class="flex flex-col md:flex-row items-center">
                    <div class="mb-4 md:mb-0 md:mr-6">                        <div class="profile-pic-container">
                            <div class="w-32 h-32 rounded-full bg-gray-200 border-4 border-white shadow-md overflow-hidden">
                                <img th:if="${profile != null and profile.profilePicture != null}" 
                                     th:src="'/' + ${profile.profilePicture}" 
                                     alt="Profile Picture" 
                                     class="user-avatar w-full h-full object-cover">
                                <div th:unless="${profile != null and profile.profilePicture != null}" 
                                     class="w-full h-full flex items-center justify-center">
                                    <i class="fas fa-user-md text-4xl text-gray-400"></i>
                                </div>
                            </div>
                            <div class="profile-overlay">
                                <i class="fas fa-camera text-white text-2xl"></i>
                            </div>
                        </div>
                    </div>                    <div class="text-center md:text-left flex-1">                        <h2 class="text-2xl font-bold text-gray-800" th:text="${profile != null and profile.firstName != null} ? ${profile.firstName + ' ' + (profile.lastName ?: '')} : (${profile != null and profile.user.firstName != null} ? ${profile.user.firstName + ' ' + (profile.user.lastName ?: '')} : 'Provider Name')">Dr. Sarah Johnson</h2>
                        <p class="text-gray-600 mb-2" th:text="${profile != null and profile.specialization != null} ? ${profile.specialization + ' at ' + (profile.workplace ?: 'Medical Center')} : 'Specialist at Medical Center'">Dermatologist at City Medical Center</p>

                        <div class="flex flex-wrap justify-center md:justify-start mb-3">
                            <span class="verification-badge">
                                <i class="fas fa-shield-alt mr-2"></i> Verified Professional
                            </span>
                            <span class="security-badge" th:if="${profile != null and profile.user.status.name() == 'ACTIVE'}">
                                <i class="fas fa-lock mr-2"></i> Secure Account
                            </span>
                        </div>

                        <div class="flex justify-center md:justify-start space-x-2">
                            <a href="#" class="social-icon facebook">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="#" class="social-icon twitter">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="social-icon linkedin">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <a href="#" class="social-icon instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </div>
                    </div>                    <div class="mt-4 md:mt-0">
                        <button id="view-public-profile" class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center">
                            <i class="fas fa-eye mr-2"></i> View Public Profile
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="tabs flex border-b border-gray-200 mb-6">
                <button class="tab-button active">Personal Information</button>
                <button class="tab-button">Professional Details</button>
                <button class="tab-button">Security</button>
                <button class="tab-button">Notifications</button>
            </div>            <!-- Personal Information Section -->
            <section id="personal-info" class="bg-white rounded-xl shadow-sm p-6 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Personal Information</h2>
                    <button type="button" id="save-personal-info" class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center">
                        <i class="fas fa-save mr-2"></i> Save Changes
                    </button>
                </div>

                <form id="personal-info-form">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">First Name</label>
                            <input type="text" id="firstName" name="firstName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.user.firstName} : ''" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Last Name</label>
                            <input type="text" id="lastName" name="lastName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.user.lastName} : ''" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Email Address</label>
                            <input type="email" id="email" name="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.user.email} : ''" required readonly>
                            <p class="text-sm text-gray-500 mt-1">Email cannot be changed</p>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Phone Number</label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.phoneNumber} : ''">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Date of Birth</label>
                            <input type="date" id="dateOfBirth" name="dateOfBirth" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.dateOfBirth} : ''">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Gender</label>
                            <select id="gender" name="gender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300">
                                <option value="">Select Gender</option>
                                <option value="MALE" th:selected="${profile != null and profile.gender == 'MALE'}">Male</option>
                                <option value="FEMALE" th:selected="${profile != null and profile.gender == 'FEMALE'}">Female</option>
                                <option value="OTHER" th:selected="${profile != null and profile.gender == 'OTHER'}">Prefer not to say</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Bio</label>
                        <textarea id="bio" name="bio" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" rows="4" th:text="${profile != null} ? ${profile.bio} : ''">Board-certified professional committed to providing personalized care.</textarea>
                    </div>
                </form>
            </section>

            <div class="profile-grid grid grid-cols-1 lg:grid-cols-2 gap-6">                <!-- Professional Details Section -->
                <section id="professional-info" class="section-card bg-white rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Professional Details</h2>
                        <button type="button" id="edit-professional" class="text-teal-600 hover:text-teal-800">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>

                    <!-- View Mode -->
                    <div id="professional-view" class="space-y-5">
                        <div>
                            <label class="block text-gray-600 font-medium mb-1">Profession</label>
                            <p class="text-gray-800 font-medium" th:text="${profile != null} ? ${profile.profession} : 'Not specified'">Dermatologist</p>
                        </div>

                        <div>
                            <label class="block text-gray-600 font-medium mb-1">Specialization</label>
                            <p class="text-gray-800 font-medium" th:text="${profile != null} ? ${profile.specialization} : 'Not specified'">Cosmetic Dermatology, Skin Cancer Prevention</p>
                        </div>

                        <div>
                            <label class="block text-gray-600 font-medium mb-1">Medical License Number</label>
                            <p class="text-gray-800 font-medium" th:text="${profile != null} ? ${profile.licenseNumber} : 'Not specified'">MED-123456789</p>
                        </div>

                        <div>
                            <label class="block text-gray-600 font-medium mb-1">Clinic/Hospital</label>
                            <p class="text-gray-800 font-medium" th:text="${profile != null} ? ${profile.workplace} : 'Not specified'">City Medical Center</p>
                        </div>

                        <div>
                            <label class="block text-gray-600 font-medium mb-1">Years of Experience</label>
                            <p class="text-gray-800 font-medium" th:text="${profile != null} ? ${profile.yearsOfExperience + ' years'} : 'Not specified'">10 years</p>
                        </div>

                        <div>
                            <label class="block text-gray-600 font-medium mb-1">Education</label>
                            <p class="text-gray-800 font-medium" th:text="${profile != null} ? ${profile.education} : 'Not specified'">MD, Harvard Medical School</p>
                        </div>

                        <div>
                            <label class="block text-gray-600 font-medium mb-1">Certifications</label>
                            <p class="text-gray-800 font-medium" th:text="${profile != null} ? ${profile.certifications} : 'Not specified'">American Board of Dermatology</p>
                        </div>
                    </div>

                    <!-- Edit Mode -->
                    <form id="professional-form" class="space-y-5 hidden">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Profession</label>
                            <input type="text" id="profession" name="profession" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.profession} : ''">
                        </div>

                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Specialization</label>
                            <input type="text" id="specialization" name="specialization" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.specialization} : ''">
                        </div>

                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Medical License Number</label>
                            <input type="text" id="licenseNumber" name="licenseNumber" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.licenseNumber} : ''">
                        </div>

                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Clinic/Hospital</label>
                            <input type="text" id="workplace" name="workplace" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.workplace} : ''">
                        </div>

                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Years of Experience</label>
                            <input type="number" id="yearsOfExperience" name="yearsOfExperience" min="0" max="50" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" th:value="${profile != null} ? ${profile.yearsOfExperience} : ''">
                        </div>

                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Education</label>
                            <textarea id="education" name="education" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" rows="3" th:text="${profile != null} ? ${profile.education} : ''"></textarea>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Certifications</label>
                            <textarea id="certifications" name="certifications" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-300" rows="3" th:text="${profile != null} ? ${profile.certifications} : ''"></textarea>
                        </div>

                        <div class="flex space-x-3">
                            <button type="button" id="save-professional" class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-save mr-2"></i> Save
                            </button>
                            <button type="button" id="cancel-professional" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-times mr-2"></i> Cancel
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Security Section -->
                <section class="section-card bg-white rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Security</h2>
                        <button class="text-teal-600 hover:text-teal-800">
                            <i class="fas fa-shield-alt"></i>
                        </button>
                    </div>

                    <div class="space-y-5">
                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Password</h3>
                                <p class="text-gray-600 text-sm">Last changed 3 months ago</p>
                            </div>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                                Change Password
                            </button>
                        </div>

                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Two-Factor Authentication</h3>
                                <p class="text-gray-600 text-sm">Add an extra layer of security</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Login Activity</h3>
                                <p class="text-gray-600 text-sm">Last login: Today at 9:30 AM from New York</p>
                            </div>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                                View History
                            </button>
                        </div>

                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Active Sessions</h3>
                                <p class="text-gray-600 text-sm">2 active sessions</p>
                            </div>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                                Manage Sessions
                            </button>
                        </div>

                        <div class="pt-4 border-t border-gray-200">
                            <h3 class="font-bold text-gray-800 mb-3">Security Tips</h3>
                            <ul class="space-y-2 text-sm text-gray-600">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-teal-500 mt-1 mr-2"></i>
                                    <span>Use a strong, unique password that you don't use elsewhere</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-teal-500 mt-1 mr-2"></i>
                                    <span>Enable two-factor authentication for extra security</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-teal-500 mt-1 mr-2"></i>
                                    <span>Regularly review your active sessions</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-teal-500 mt-1 mr-2"></i>
                                    <span>Be cautious of suspicious emails or messages</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Notification Preferences -->
                <section class="section-card bg-white rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Notification Preferences</h2>
                        <button class="text-teal-600 hover:text-teal-800">
                            <i class="fas fa-bell"></i>
                        </button>
                    </div>

                    <div class="space-y-5">
                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Email Notifications</h3>
                                <p class="text-gray-600 text-sm">Receive notifications via email</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">SMS Notifications</h3>
                                <p class="text-gray-600 text-sm">Receive notifications via text message</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">App Notifications</h3>
                                <p class="text-gray-600 text-sm">Receive in-app notifications</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="pt-4">
                            <h3 class="font-bold text-gray-800 mb-3">Notification Types</h3>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <h4 class="font-medium text-gray-800">New Appointment Requests</h4>
                                        <p class="text-gray-600 text-sm">Notify me when I receive new appointment requests</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>

                                <div class="flex justify-between items-center">
                                    <div>
                                        <h4 class="font-medium text-gray-800">Appointment Reminders</h4>
                                        <p class="text-gray-600 text-sm">Remind me about upcoming appointments</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>

                                <div class="flex justify-between items-center">
                                    <div>
                                        <h4 class="font-medium text-gray-800">Cancellations</h4>
                                        <p class="text-gray-600 text-sm">Notify me when appointments are cancelled</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>

                                <div class="flex justify-between items-center">
                                    <div>
                                        <h4 class="font-medium text-gray-800">New Reviews</h4>
                                        <p class="text-gray-600 text-sm">Notify me when I receive new patient reviews</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Account Preferences -->
                <section class="section-card bg-white rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Account Preferences</h2>
                        <button class="text-teal-600 hover:text-teal-800">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>

                    <div class="space-y-5">
                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Language Preference</h3>
                                <p class="text-gray-600 text-sm">English (US)</p>
                            </div>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                                Change
                            </button>
                        </div>

                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Time Zone</h3>
                                <p class="text-gray-600 text-sm">Eastern Time (ET)</p>
                            </div>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                                Change
                            </button>
                        </div>

                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="font-medium text-gray-800">Calendar Sync</h3>
                                <p class="text-gray-600 text-sm">Not connected</p>
                            </div>
                            <button class="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                                Connect
                            </button>
                        </div>

                        <div class="pt-4 border-t border-gray-200">
                            <h3 class="font-bold text-gray-800 mb-3">Danger Zone</h3>
                            <div class="space-y-3">
                                <button class="w-full bg-red-50 border border-red-200 text-red-600 hover:bg-red-100 py-3 rounded-lg transition-colors flex items-center justify-center">
                                    <i class="fas fa-ban mr-2"></i> Deactivate Account
                                </button>
                                <button class="w-full bg-red-50 border border-red-200 text-red-600 hover:bg-red-100 py-3 rounded-lg transition-colors flex items-center justify-center">
                                    <i class="fas fa-trash-alt mr-2"></i> Delete Account Permanently
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Content Overlay -->
    <div id="content-overlay"></div>    <script>
        // Mobile sidebar toggle
        document.getElementById('toggle-sidebar').addEventListener('click', () => {
            document.getElementById('sidebar').classList.add('active');
        });

        document.getElementById('close-sidebar').addEventListener('click', () => {
            document.getElementById('sidebar').classList.remove('active');
        });

        document.getElementById('content-overlay').addEventListener('click', () => {
            document.getElementById('sidebar').classList.remove('active');
        });

        // Tab functionality
        document.querySelectorAll('.tab-button').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
                this.classList.add('active');

                // Hide all sections
                document.querySelectorAll('section').forEach(section => {
                    section.style.display = 'none';
                });

                // Show the relevant section based on tab
                const tabText = this.textContent.toLowerCase().replace(' ', '-');
                switch(tabText) {
                    case 'personal-information':
                        document.getElementById('personal-info').style.display = 'block';
                        break;
                    case 'professional-details':
                        document.getElementById('professional-info').style.display = 'block';
                        break;
                    case 'security':
                        document.querySelectorAll('.section-card').forEach(card => {
                            if (card.querySelector('h2').textContent.includes('Security')) {
                                card.style.display = 'block';
                            }
                        });
                        break;
                    case 'notifications':
                        document.querySelectorAll('.section-card').forEach(card => {
                            if (card.querySelector('h2').textContent.includes('Notification')) {
                                card.style.display = 'block';
                            }
                        });
                        break;
                }
            });
        });        // Personal Information Form Submission
        document.getElementById('save-personal-info').addEventListener('click', async function() {
            const saveButton = this;
            const originalText = saveButton.textContent;
            
            // Show loading state
            saveButton.disabled = true;
            saveButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Saving...';
            
            const form = document.getElementById('personal-info-form');
            const formData = new FormData(form);
            
            const data = {
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                phoneNumber: formData.get('phoneNumber'),
                dateOfBirth: formData.get('dateOfBirth'),
                gender: formData.get('gender'),
                bio: formData.get('bio')
            };

            try {
                const response = await fetch('/provider/profile-settings/personal', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const updatedProfile = await response.json();
                    showNotification('Personal information updated successfully!', 'success');
                    
                    // Update the display name in header
                    const nameDisplay = document.querySelector('h2.text-2xl');
                    if (nameDisplay) {
                        nameDisplay.textContent = `${updatedProfile.firstName || ''} ${updatedProfile.lastName || ''}`.trim() || 'Provider Name';
                    }
                    
                    // Update all personal info display elements with fresh data from database
                    updatePersonalInfoDisplay(updatedProfile);
                    
                } else {
                    const error = await response.json();
                    showNotification(error.error || 'Failed to update personal information', 'error');
                }
            } catch (error) {
                showNotification('Error updating personal information', 'error');
                console.error('Error:', error);
            } finally {
                // Restore button state
                saveButton.disabled = false;
                saveButton.textContent = originalText;
            }
        });

        // Professional Details Edit/Save functionality
        document.getElementById('edit-professional').addEventListener('click', function() {
            document.getElementById('professional-view').classList.add('hidden');
            document.getElementById('professional-form').classList.remove('hidden');
        });

        document.getElementById('cancel-professional').addEventListener('click', function() {
            document.getElementById('professional-view').classList.remove('hidden');
            document.getElementById('professional-form').classList.add('hidden');
        });        document.getElementById('save-professional').addEventListener('click', async function() {
            const saveButton = this;
            const originalText = saveButton.textContent;
            
            // Show loading state
            saveButton.disabled = true;
            saveButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Saving...';
            
            const form = document.getElementById('professional-form');
            const formData = new FormData(form);
            
            const data = {
                profession: formData.get('profession'),
                specialization: formData.get('specialization'),
                licenseNumber: formData.get('licenseNumber'),
                workplace: formData.get('workplace'),
                yearsOfExperience: parseInt(formData.get('yearsOfExperience')) || 0,
                education: formData.get('education'),
                certifications: formData.get('certifications')
            };            try {
                const response = await fetch('/provider/profile-settings/professional', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const updatedProfile = await response.json();
                    showNotification('Professional details updated successfully!', 'success');
                    
                    // Update the view mode with fresh data from database
                    updateProfessionalView(updatedProfile);
                    document.getElementById('professional-view').classList.remove('hidden');
                    document.getElementById('professional-form').classList.add('hidden');
                } else {
                    const error = await response.json();
                    showNotification(error.error || 'Failed to update professional details', 'error');
                }            } catch (error) {
                showNotification('Error updating professional details', 'error');
                console.error('Error:', error);
            } finally {
                // Restore button state
                saveButton.disabled = false;
                saveButton.textContent = originalText;
            }
        });

        // Function to update personal info display with fresh data from database
        function updatePersonalInfoDisplay(profile) {
            // Update form fields with fresh data from the nested user object and profile
            if (profile.user) {
                if (profile.user.firstName) document.getElementById('firstName').value = profile.user.firstName;
                if (profile.user.lastName) document.getElementById('lastName').value = profile.user.lastName;
                if (profile.user.email) document.getElementById('email').value = profile.user.email;
            }
            
            // Update profile-specific fields
            if (profile.phoneNumber) document.getElementById('phoneNumber').value = profile.phoneNumber;
            if (profile.dateOfBirth) {
                const dateInput = document.getElementById('dateOfBirth');
                // Ensure proper date format
                const date = new Date(profile.dateOfBirth);
                dateInput.value = date.toISOString().split('T')[0];
            }
            if (profile.gender) document.getElementById('gender').value = profile.gender;
            if (profile.bio) document.getElementById('bio').value = profile.bio;
            
            // Update display elements that show personal info
            const nameElements = document.querySelectorAll('[data-field="name"]');
            nameElements.forEach(el => {
                const fullName = profile.user ? `${profile.user.firstName || ''} ${profile.user.lastName || ''}`.trim() : '';
                el.textContent = fullName || 'Not specified';
            });
            
            // Update header name display
            const nameDisplay = document.querySelector('h2.text-2xl');
            if (nameDisplay && profile.user) {
                const fullName = `${profile.user.firstName || ''} ${profile.user.lastName || ''}`.trim();
                nameDisplay.textContent = fullName || 'Provider Name';
            }
        }

        // Function to update professional view mode with fresh data from database
        function updateProfessionalView(profile) {
            const viewSection = document.getElementById('professional-view');
            const paragraphs = viewSection.querySelectorAll('p');
            
            // Update view mode paragraphs
            if (paragraphs[0]) paragraphs[0].textContent = profile.profession || 'Not specified';
            if (paragraphs[1]) paragraphs[1].textContent = profile.specialization || 'Not specified';
            if (paragraphs[2]) paragraphs[2].textContent = profile.licenseNumber || 'Not specified';
            if (paragraphs[3]) paragraphs[3].textContent = profile.workplace || 'Not specified';
            if (paragraphs[4]) paragraphs[4].textContent = profile.yearsOfExperience ? `${profile.yearsOfExperience} years` : 'Not specified';
            if (paragraphs[5]) paragraphs[5].textContent = profile.education || 'Not specified';
            if (paragraphs[6]) paragraphs[6].textContent = profile.certifications || 'Not specified';
            
            // Update form fields with fresh data (in case user edits again)
            if (profile.profession) document.getElementById('profession').value = profile.profession;
            if (profile.specialization) document.getElementById('specialization').value = profile.specialization;
            if (profile.licenseNumber) document.getElementById('licenseNumber').value = profile.licenseNumber;
            if (profile.workplace) document.getElementById('workplace').value = profile.workplace;
            if (profile.yearsOfExperience) document.getElementById('yearsOfExperience').value = profile.yearsOfExperience;
            if (profile.education) document.getElementById('education').value = profile.education;            if (profile.certifications) document.getElementById('certifications').value = profile.certifications;
        }

        // Notification system
        function showNotification(message, type = 'info') {
            // Remove any existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification fixed top-4 right-4 p-4 rounded-lg text-white z-50 shadow-lg transform transition-all duration-300 ease-in-out ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 'bg-blue-500'
            }`;
            notification.style.transform = 'translateX(100%)'; // Start off-screen
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);
            
            // Auto remove after 5 seconds with animation
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }                }, 300);
            }, 5000);
        }

        // Profile picture change
        document.querySelector('.profile-overlay').addEventListener('click', function() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async function(event) {
                const file = event.target.files[0];
                if (file) {
                    // Validate file size (max 5MB)
                    if (file.size > 5 * 1024 * 1024) {
                        showNotification('File size must be less than 5MB', 'error');
                        return;
                    }
                    
                    // Validate file type
                    if (!file.type.startsWith('image/')) {
                        showNotification('Please select a valid image file', 'error');
                        return;
                    }
                    
                    try {
                        const formData = new FormData();
                        formData.append('file', file);
                        
                        const response = await fetch('/provider/profile-settings/upload-picture', {
                            method: 'POST',
                            body: formData
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                              // Show preview immediately
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                const profileContainer = document.querySelector('.profile-pic-container .w-32');
                                profileContainer.innerHTML = `<img src="${e.target.result}" alt="Profile Picture" class="user-avatar w-full h-full object-cover">`;
                            };
                            reader.readAsDataURL(file);
                            
                            showNotification('Profile picture updated successfully!', 'success');
                        } else {
                            const error = await response.json();
                            showNotification(error.error || 'Failed to upload profile picture', 'error');
                        }
                    } catch (error) {
                        showNotification('Error uploading profile picture', 'error');
                        console.error('Error:', error);
                    }
                }
            };
            input.click();
        });

        // Function to refresh all profile data from server
        async function refreshProfileData() {
            try {
                const response = await fetch('/provider/profile-settings/data');
                if (response.ok) {
                    const profile = await response.json();
                    updatePersonalInfoDisplay(profile);
                    updateProfessionalView(profile);
                    
                    // Update profile picture if available
                    if (profile.profilePicture) {
                        const profileImg = document.querySelector('.user-avatar');
                        if (profileImg) {
                            profileImg.src = profile.profilePicture;
                        }
                    }
                    
                    return profile;
                } else {
                    console.error('Failed to refresh profile data');
                    return null;
                }
            } catch (error) {
                console.error('Error refreshing profile data:', error);
                return null;            }
        }

        // View Public Profile functionality
        function showPublicProfile() {
            // Create a modal to show the public profile preview
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-gray-800">Public Profile Preview</h3>
                            <button class="close-modal text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times text-2xl"></i>
                            </button>
                        </div>
                        
                        <div class="text-center mb-6">
                            <div class="w-32 h-32 rounded-full mx-auto mb-4 overflow-hidden bg-gradient-to-br from-teal-400 to-royal-purple flex items-center justify-center">
                                <i class="fas fa-user-md text-white text-4xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800" id="modal-name">Loading...</h2>
                            <p class="text-gray-600 mb-2" id="modal-specialization">Loading...</p>
                            <p class="text-sm text-gray-500" id="modal-experience">Loading...</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-2">Contact Information</h4>
                                    <p class="text-gray-600" id="modal-workplace">Loading...</p>
                                    <p class="text-gray-600" id="modal-phone">Loading...</p>
                                </div>
                                
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-2">Professional Details</h4>
                                    <p class="text-gray-600" id="modal-license">Loading...</p>
                                    <p class="text-gray-600" id="modal-education">Loading...</p>
                                </div>
                            </div>
                            
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-2">About</h4>
                                    <p class="text-gray-600" id="modal-bio">Loading...</p>
                                </div>
                                
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-2">Certifications</h4>
                                    <p class="text-gray-600" id="modal-certifications">Loading...</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 text-center">
                            <button class="close-modal bg-teal-600 hover:bg-teal-700 text-white px-6 py-2 rounded-lg transition-colors">
                                Close Preview
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal functionality
            modal.addEventListener('click', function(e) {
                if (e.target === modal || e.target.classList.contains('close-modal')) {
                    document.body.removeChild(modal);
                }
            });
            
            // Populate modal with current profile data
            populateModalWithProfileData();
        }

        async function populateModalWithProfileData() {
            try {
                const response = await fetch('/provider/profile-settings/data');
                if (response.ok) {
                    const profile = await response.json();
                    
                    // Update modal content with profile data
                    const modalName = document.getElementById('modal-name');
                    const modalSpecialization = document.getElementById('modal-specialization');
                    const modalExperience = document.getElementById('modal-experience');
                    const modalWorkplace = document.getElementById('modal-workplace');
                    const modalPhone = document.getElementById('modal-phone');
                    const modalLicense = document.getElementById('modal-license');
                    const modalEducation = document.getElementById('modal-education');
                    const modalBio = document.getElementById('modal-bio');
                    const modalCertifications = document.getElementById('modal-certifications');
                    
                    if (modalName) {
                        const fullName = profile.user ? `${profile.user.firstName || ''} ${profile.user.lastName || ''}`.trim() : '';
                        modalName.textContent = fullName || 'Provider Name';
                    }
                    
                    if (modalSpecialization) {
                        modalSpecialization.textContent = profile.specialization || 'Specialist';
                    }
                    
                    if (modalExperience) {
                        modalExperience.textContent = profile.yearsOfExperience ? 
                            `${profile.yearsOfExperience} years of experience` : 'Experience not specified';
                    }
                    
                    if (modalWorkplace) {
                        modalWorkplace.textContent = profile.workplace || 'Workplace not specified';
                    }
                    
                    if (modalPhone) {
                        modalPhone.textContent = profile.phoneNumber || 'Phone not specified';
                    }
                    
                    if (modalLicense) {
                        modalLicense.textContent = profile.licenseNumber ? 
                            `License: ${profile.licenseNumber}` : 'License not specified';
                    }
                    
                    if (modalEducation) {
                        modalEducation.textContent = profile.education || 'Education not specified';
                    }
                    
                    if (modalBio) {
                        modalBio.textContent = profile.bio || 'Bio not specified';
                    }
                    
                    if (modalCertifications) {
                        modalCertifications.textContent = profile.certifications || 'Certifications not specified';
                    }
                    
                } else {
                    console.error('Failed to fetch profile data for modal');
                }
            } catch (error) {
                console.error('Error fetching profile data for modal:', error);
            }        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', async function() {
            // Show personal info section by default
            document.querySelectorAll('section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById('personal-info').style.display = 'block';

            // Refresh profile data on page load
            await refreshProfileData();

            // Add hover effect to all cards
            const cards = document.querySelectorAll('.section-card');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.1)';
                });

                card.addEventListener('mouseleave', function() {                    this.style.boxShadow = '';
                });
            });

            // Toggle switches functionality
            document.querySelectorAll('.toggle-switch input').forEach(toggle => {
                toggle.addEventListener('change', function() {
                    const label = this.closest('.flex').querySelector('h3, h4').textContent;
                    showNotification(`${label} ${this.checked ? 'enabled' : 'disabled'}`, 'info');
                });
            });

            // View Public Profile button functionality
            const viewProfileButton = document.getElementById('view-public-profile');
            if (viewProfileButton) {
                viewProfileButton.addEventListener('click', function() {
                    showPublicProfile();
                });
            }
        });
    </script>
</body>
</html>